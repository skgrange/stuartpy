#!/usr/bin/env python

import os
import argparse
from xml.dom import minidom
from xml.dom.minidom import Node

# os.getcwd()

# Define arguments
parser = argparse.ArgumentParser()
parser.add_argument("-i", "--input_file", default = "", 
                    help = "File name of XML file.")
parser.add_argument("-o", "--output_file", default = "", 
                    help = "File name of converted file.")
                    
# Parse arguments
args = parser.parse_args()

# Load file
# xml = xml.dom.minidom.parse(args.input_file)

# Remove whitespace
# xml_string = xml.toprettyxml(indent = "", newl = "")

# Pretty print
# Load file
# xml_string = xml.toprettyxml(indent = "  ")

# Save xml as text
#f = open(args.output_file, "wb")
#f.write(xml_string)
#f.close()

# http://stackoverflow.com/questions/3310614/remove-whitespaces-in-xml-string

def remove_blanks(node):
  for x in node.childNodes:
    if x.nodeType == Node.TEXT_NODE:
      if x.nodeValue:
        x.nodeValue = x.nodeValue.strip()
    elif x.nodeType == Node.ELEMENT_NODE:
      remove_blanks(x)

xml = minidom.parse(args.input_file)
remove_blanks(xml)
xml.normalize()

with file(args.output_file, "w") as result:
  result.write(xml.toprettyxml(indent = "  "))


